---
title: '**Visualisation**: Assignment 1'
author: 'Name: Adarsha Mondal | Roll Number: MDS202205'
date: "Dead Line : 02 Oct 2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(gridExtra)
library(reshape2)
library(ggpubr)
```

## Instruction:

1)  Work on the \`Assignment1.Rmd' file. Compile the file as pdf. Submit only the pdf file in moodle.
2)  Make sure you write your name and roll number at the top of the \`Assignment1.Rmd' file.

## Total Marks: 10 points

## Problem 1 (3 points)

**Problem Statement:** Write an $\texttt{R}$ function which will test Central Limit Theorem.

-   Assume the underlying population distribution follow Poisson distribution with rate parameter $\lambda$
-   We want to estimate the unknown $\lambda$ with the sample mean $$\hat{\lambda}=\frac{1}{n}\sum_{i=1}^{n}X_i$$
-   The exact sampling distribution of $\hat{\lambda}$ is unknown
-   But CLT tells us that as sample size $n$ increases the sampling distribution of $\hat{\lambda}$ can be approximated by Gaussian distribution.

### **Input in the function:**

-   $n$: sample size
-   $\lambda$ : rate parameter
-   $N$: simulation size

## **Output from the function:**

-   Histogram of the sampling distribution using `ggplot`
-   QQ-plot using `ggplot`

## **Test cases:**

-   case 1 a: $\lambda =0.7$, n=10, N=5000

-   case 1 b: $\lambda=0.7$, n=30, N=5000

-   case 1 c: $\lambda=0.7$, n=100, N=5000

-   case 1 c: $\lambda=0.7$, n=300, N=5000

-   case 2 a: $\lambda=1.7$, n=10, N=5000

-   case 2 b: $\lambda=1.7$, n=30, N=5000

-   case 2 c: $\lambda=1.7$, n=100, N=5000

-   case 2 c: $\lambda=1.7$, n=300, N=5000

```{r}
theme_set(theme_pubr())
problem_1 = function(lambda, sample_size, sim_size){
  samplings_mean_df = data.frame(smpl_mean=replicate(sim_size,mean(rpois(sample_size,lambda))))
  
  hist = ggplot(data=samplings_mean_df)+aes(x=smpl_mean)+
    geom_histogram(color = "white", fill = "black", bins = 20)+
    theme(legend.position = "none")+
    labs(x = "Sample means", y = "Count")+
    theme(axis.line = element_line(colour = "darkblue", size = 1, linetype = "solid"), axis.title.x = element_text(face="bold",size=9), axis.title.y = element_text(face="bold",size=9))
  
  qq = ggplot(samplings_mean_df, aes(sample = smpl_mean)) + 
    stat_qq() + stat_qq_line() + labs(x = "Theoretical", y = "Sample")+
    theme(axis.line = element_line(colour = "darkblue", size = 1, linetype = "solid"), axis.title.x = element_text(face="bold",size=9), axis.title.y = element_text(face="bold",size=9))

  return(list(hist, qq))
}

lambda_vals = c(0.7,1.7)
test_cases = c(10,30,100,300)

plots = list()
for (lambda in lambda_vals){
  for (test in test_cases){
    #plots = append(plots, grid.arrange(grobs = problem_1(lambda,test,5000),top = paste("lambda =",lambda,"| sample size =",test,sep = " "), ncol = 2))
    grid.arrange(grobs = problem_1(lambda,test,5000),top = paste("lambda =",lambda,"| sample size =",test,sep = " "), ncol = 2)
  }
}


```

### **Problem 2:** (2 points)

Consider the `JohnsonJohnson` dataset. The datset contains the Quarterly earnings (dollars) per Johnson & Johnson share 1960--80.

a)  Draw the time series plot of Quarterly earnings in regular scale and log-scale using the `ggplot` (1 point)

```{r}
head(JohnsonJohnson)
```

```{r}
library(ggplot2)
library(ggpubr)
theme_set(theme_pubr())

problem_2 = function(){
  jj_earnings_df = data.frame(time = time(JohnsonJohnson), earnings = JohnsonJohnson)

  line = ggplot(data = jj_earnings_df, aes(x = time, y = earnings)) + 
  geom_line(color = "#00AFBB", size = 1)

  log = ggplot(data = jj_earnings_df, aes(x = time, y = earnings)) + 
  geom_line(color = "red", size = 1) + scale_y_continuous(trans = "log2")
  
  figure = ggarrange(line, log, ncol = 2, labels = c("Nomal Scale", "Y-Log Graph"))
  return(figure)
}
problem_2()
```

### **Problem 3:** (2 points)

-   An experiment was conducted to measure and compare the effectiveness of various feed supplements on the growth rate of chickens.

-   Following R-code is a standard side-by-side boxplot showing effect of feed supplements on the growth rate of chickens.

```{r,fig=T}
boxplot(weight~feed,data=chickwts,pch=20
        ,main = "chickwt data"
        ,ylab = "Weight at six weeks (gm)"
        ,xlab = "Feed Type")
```

a)  Reproduce the same plot using the `ggplot`; while fill each boxes with different colour.

b)  In addition draw probability density plot for weights of chicken's growth by each feed seperately using the `ggplot`. Draw this plot seperately.

```{r}
library(ggplot2)
problem_3 = function(){
  chickwts_df = data.frame(chickwts)
  figure = ggplot(chickwts_df, aes(x = feed, y = weight, color = feed)) + geom_boxplot()
  return(figure)
}
problem_3()
```

### **Problem 4:** (3 points)

Consider the `EuStockMarkets` data available in `R`. Contains the daily closing prices of major European stock indices: Germany DAX (Ibis), Switzerland SMI, France CAC, and UK FTSE. The data are sampled in business time, i.e., weekends and holidays are omitted.

```{r}
head(EuStockMarkets)
```

-   Suppose $P_t$ is the closing price of a stock indices on day $t$.
-   The daily return $r_t$ is defined as $$
    r_t = \log(P_t)-\log(P_{t-1}).
    $$

a)  Draw time-series plot of $P_t$ for all four markets
b)  Draw time-series plot of $r_t$ for all four markets
c)  Draw histogram of $P_t$ for all four markets
d)  Draw histogram of $r_t$ for all four markets
e)  Suppose you invested \$ 1000 in each market indices on day 1. Plot how your investment grows on the same plot for all four markets. Make your plot using `ggplot`.
f)  Check which market outperform others during the same time?

Make all your plots using `ggplot`.

```{r}
## write your R-function for problem 4 here
##
##
```
